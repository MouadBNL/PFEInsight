import{u as F,_ as R}from"./CreateCompanyModal.js";import{u as $}from"./StudentApiService.js";import{u as B,_ as D}from"./CreateTechnologyModal.js";import{e as z,l as u,m as V,A as O,F as P,o as _,n as y,y as m,f as r,u as n,R as H,w as o,$ as Z,x as G,Z as S,T as J,p as K,t as f,s as i,v as E,P as N,z as h,D as g}from"./vendor.js";import{u as Q}from"./InternshipApiService.js";import"./AbstractApiService.js";const W=h("Ajouter un stage"),X={key:0,class:"h-96 flex items-center justify-center"},Y={key:1},ee={class:"grid grid-cols-2 gap-8"},te={class:"flex items-center gap-8"},re=h(" Ajouter une entreprise "),ne={class:"flex items-center gap-8"},ae=h(" Ajouter une technologie "),se=h(" Ajouter "),ve=z({setup(le){const w=u(null),s=u({title:"",description:"",supervisor_name:"",supervisor_phone:"",company_id:0,technologies:[]}),x=$(),j=Q(),L=F(),q=B(),b=V(),C=O(),p=u([]),d=u(!1),A=a=>{p.value.push(a),s.value.company_id=a.value,d.value=!1},c=u([]),v=u(!1),I=a=>{c.value.push(a),s.value.technologies.push(a.value),v.value=!1};P(async()=>{(await x.getProfile()).data.internship!=null&&b.push({name:"auth.students.internship"});const e=await L.get();p.value=e.data.map(l=>({value:l.id,label:l.name+" "+l.city,name:l.name,city:l.city}));const t=await q.get();c.value=t.data.map(l=>({label:l.name,value:l.id}))});const T=a=>g("div",{class:"px-2 py-1"},[g("div",{class:"mb-1"},[a.name]),g("div",{class:"mb-1 text-gray-300"},[a.city])]),U=({option:a})=>g("div",{},[a.name]),k={title:[{required:!0,trigger:["input","blur"],validator:(a,e)=>e?e.length>255?new Error("Le titre ne peut pas contenir plus de 255 caract\xE8res"):!0:new Error("Le titre est requis")}],description:[{trigger:["input","blur"],validator:(a,e)=>e.length>2e3?new Error("La description ne peut pas contenir plus de 2000 caract\xE8res"):!0}],supervisor_name:[{required:!0,trigger:["input","blur"],validator:(a,e)=>e?e.length>255?new Error("Le nom de l'encadrant ne peut pas contenir plus de 255 caract\xE8res"):!0:new Error("Le nom de l'encadrant est requis")}],supervisor_phone:[{required:!0,trigger:["input","blur"],validator:(a,e)=>e?e.length>20?new Error("Le numero de l'encadrant ne peut pas contenir plus de 20 caract\xE8res"):!0:new Error("Le numero de l'encadrant est requis")}],company_id:[{required:!0,trigger:["input","blur"],validator:(a,e)=>{const t=p.value.map(l=>l.value);if(e){if(!t.includes(e))return new Error("L'entreprise est invalide")}else return new Error("L'entreprise est requise");return!0}}],technologies:[{required:!0,trigger:["input","blur"],validator:(a,e)=>{const t=c.value.map(l=>l.value);return!e||e.length==0?new Error("Les technologies sont requises"):e.every(l=>t.includes(l))?!0:new Error("L'entreprise est invalide")}}]},M=a=>{a.preventDefault(),w.value.validate(async e=>{e?C.error("Il y a un probl\xE8me avec votre formulaire, veuillez r\xE9essayer"):(await j.store(s.value),C.success("Stage cr\xE9\xE9 avec succ\xE8s"),b.push({name:"auth.students.internship"}))})};return(a,e)=>(_(),y(J,null,[m("div",null,[r(n(H),null,{default:o(()=>[W]),_:1})]),n(x).isLoading.value?(_(),y("div",X,[r(n(Z),{size:"large"})])):(_(),y("div",Y,[r(n(G),{title:"Formulaire de stage"},{default:o(()=>[r(n(K),{model:s.value,ref:(t,l)=>{l.formRef=t,w.value=t},rules:k},{default:o(()=>[r(n(i),{path:"title",label:"Intitul\xE9 du sujet"},{default:o(()=>[r(n(f),{value:s.value.title,"onUpdate:value":e[0]||(e[0]=t=>s.value.title=t),placeholder:"Intitul\xE9 du sujet"},null,8,["value"])]),_:1}),r(n(i),{path:"description",label:"Description"},{default:o(()=>[r(n(f),{value:s.value.description,"onUpdate:value":e[1]||(e[1]=t=>s.value.description=t),type:"textarea",placeholder:"Description"},null,8,["value"])]),_:1}),m("div",ee,[r(n(i),{path:"supervisor_name",label:"Nom et le pr\xE9nom de l'encadrant"},{default:o(()=>[r(n(f),{value:s.value.supervisor_name,"onUpdate:value":e[2]||(e[2]=t=>s.value.supervisor_name=t),placeholder:"Nom et le pr\xE9nom de l'encadrant"},null,8,["value"])]),_:1}),r(n(i),{path:"supervisor_phone",label:"Telephone de l'encadrant "},{default:o(()=>[r(n(f),{value:s.value.supervisor_phone,"onUpdate:value":e[3]||(e[3]=t=>s.value.supervisor_phone=t),placeholder:"Telephone de l'encadrant "},null,8,["value"])]),_:1})]),m("div",te,[r(n(E),{onClick:e[4]||(e[4]=t=>d.value=!0)},{default:o(()=>[re]),_:1}),r(n(i),{path:"company_id",label:"Entreprise",class:"w-full"},{default:o(()=>[r(n(N),{value:s.value.company_id,"onUpdate:value":e[5]||(e[5]=t=>s.value.company_id=t),options:p.value,"render-label":T,"render-tag":U,filterable:""},null,8,["value","options"])]),_:1})]),m("div",ne,[r(n(E),{onClick:e[6]||(e[6]=t=>v.value=!0)},{default:o(()=>[ae]),_:1}),r(n(i),{path:"technologies",label:"Technologies",class:"w-full"},{default:o(()=>[r(n(N),{value:s.value.technologies,"onUpdate:value":e[7]||(e[7]=t=>s.value.technologies=t),options:c.value,multiple:"",filterable:""},null,8,["value","options"])]),_:1})]),r(n(E),{onClick:M},{default:o(()=>[se]),_:1})]),_:1},8,["model"])]),_:1})])),r(n(S),{show:d.value,"onUpdate:show":e[8]||(e[8]=t=>d.value=t)},{default:o(()=>[r(R,{onCreated:A})]),_:1},8,["show"]),r(n(S),{show:v.value,"onUpdate:show":e[9]||(e[9]=t=>v.value=t)},{default:o(()=>[r(D,{onCreated:I})]),_:1},8,["show"])],64))}});export{ve as default};
