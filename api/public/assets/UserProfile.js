var B=Object.defineProperty,z=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var C=(m,s,n)=>s in m?B(m,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[s]=n,N=(m,s)=>{for(var n in s||(s={}))Y.call(s,n)&&C(m,n,s[n]);if(T)for(var n of T(s))H.call(s,n)&&C(m,n,s[n]);return m},D=(m,s)=>z(m,O(s));import{e as j,A as P,l as $,o as g,n as w,y as c,u as e,f as r,w as a,v as y,L as F,z as _,M as A,c as Q,s as x,t as q,O as S,q as k,p as K,x as M,F as J,P as G,Q as W,R,S as L,T as X}from"./vendor.js";import{_ as Z,u as V}from"./index.js";import{u as I,U as ee}from"./UserApiService.js";import{u as te}from"./VerifyTokenService.js";import{u as re}from"./StudentApiService.js";import"./AbstractApiService.js";const ae={class:"w-full"},se={class:"h-64 w-64 bg-gray-50 relative rounded-full overflow-hidden mb-4 mx-auto"},oe=["src"],le=_("Changer ma photo de profile"),ie=_("Supprimer mon image"),ne=j({setup(m){const s=I(),n=I(),v=P(),h=V(),E=$(0),u=({file:i})=>{const f=new FormData;f.append("profile_picture",i.file),s.uploadProfilePicture(f).then(t=>{h.profile_picture=t.data.data.profile_picture,v.success("Votre photo de profil a \xE9t\xE9 mise \xE0 jour")}).finally(()=>{E.value++})},b=()=>{n.uploadProfilePicture({profile_picture:null}).then(i=>{h.profile_picture=i.data.data.profile_picture,v.success("Votre photo de profil a \xE9t\xE9 mise \xE0 jour")})};return(i,f)=>(g(),w("div",ae,[c("div",se,[c("img",{src:e(h).profile_picture,alt:"",class:"absolute h-full w-full object-cover"},null,8,oe)]),(g(),w("div",{class:"flex items-center justify-center gap-4",key:E.value},[r(e(F),{style:{display:"inline-block",width:"fit-content",height:"fit-content"},action:"https://www.mocky.io/v2/5e4bafc63100007100d8b70f",multiple:!1,customRequest:u,accept:".jpeg,.png,.jpg,.gif,.svg"},{default:a(()=>[r(e(y),{loading:e(s).isLoading.value},{default:a(()=>[le]),_:1},8,["loading"])]),_:1}),r(e(y),{type:"error",onClick:b,loading:e(n).isLoading.value,class:"mb-2"},{default:a(()=>[ie]),_:1},8,["loading"])]))]))}});var de=Z(ne,[["__scopeId","data-v-57076d3c"]]);const ue={class:"flex ga-8"},pe={class:"w-1/3"},ce={class:"w-2/3"},fe={class:"flex gap-8"},me={class:"flex gap-8"},_e={class:"flex justify-end"},ve=_("Mettre \xE0 jour mes identifiants"),ge=j({setup(m){const s=V(),n=te(),v=I(),h=P(),E=$(null),u=A({first_name:s.first_name,last_name:s.last_name,email:s.email,password:void 0,password_confirmation:void 0}),b={first_name:{required:!0,trigger:["input","blur"],validator:(f,t)=>t?t.length>255?new Error("Pr\xE9nom ne doit pas depasser 255 charactere"):!0:new Error("Pr\xE9nom est requis")},last_name:{required:!0,trigger:["input","blur"],validator:(f,t)=>t?t.length>255?new Error("Nom ne doit pas depasser 255 charactere"):!0:new Error("Nom est requis")},email:{required:!0,trigger:["input","blur"],validator:(f,t)=>t?t.length>255?new Error("Email ne doit pas depasser 255 charactere"):/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)?!0:new Error("veuillez entrer un email valide"):new Error("Email est requis")},role:{required:!0,trigger:["input","blur"],validator:(f,t)=>t?!0:new Error("Role est requis")},password:{required:!0,trigger:["input","blur"],validator:(f,t)=>t?t.length>255?new Error("Mot de passe ne doit pas depasser 255 charactere"):t.length<8?new Error("Mot de passe ne doit pas avoir mois de 8 charactere"):!0:new Error("Mot de passe est requis")},password_confirmation:{required:!0,trigger:["input","blur"],validator:(f,t)=>t?t!=u.password?new Error("Le mot de passe n'est pas le m\xEAme"):!0:new Error("La confirmation du mot de passe est requise")}},i=()=>{E.value.validate(async f=>{if(f)h.error("Veuillez remplir les donn\xE9es valides");else try{await v.update(u),await n.verifyToken(),h.success("Vos identifiants ont \xE9t\xE9 mis \xE0 jour")}catch{}})};return(f,t)=>(g(),Q(e(M),{title:"Information utilisateur",class:"mb-8"},{default:a(()=>[r(e(K),{model:e(u),ref:(p,l)=>{l.formRef=p,E.value=p},rules:b},{default:a(()=>[c("div",ue,[c("div",pe,[r(de)]),c("div",ce,[c("div",fe,[r(e(x),{path:"first_name",label:"Pr\xE9nom",class:"w-1/2"},{default:a(()=>[r(e(q),{value:e(u).first_name,"onUpdate:value":t[0]||(t[0]=p=>e(u).first_name=p),onKeydown:t[1]||(t[1]=S(k(()=>{},["prevent"]),["enter"])),placeholder:"Mouad"},null,8,["value"])]),_:1}),r(e(x),{path:"last_name",label:"Nom",class:"w-1/2"},{default:a(()=>[r(e(q),{value:e(u).last_name,"onUpdate:value":t[2]||(t[2]=p=>e(u).last_name=p),onKeydown:t[3]||(t[3]=S(k(()=>{},["prevent"]),["enter"])),placeholder:"Benali"},null,8,["value"])]),_:1})]),r(e(x),{path:"email",label:"Email"},{default:a(()=>[r(e(q),{value:e(u).email,"onUpdate:value":t[4]||(t[4]=p=>e(u).email=p),onKeydown:t[5]||(t[5]=S(k(()=>{},["prevent"]),["enter"])),placeholder:"mouad.benali1@uit.ac.ma"},null,8,["value"])]),_:1}),c("div",me,[r(e(x),{path:"password",label:"Mot de passe",class:"w-1/2"},{default:a(()=>[r(e(q),{value:e(u).password,"onUpdate:value":t[6]||(t[6]=p=>e(u).password=p),onKeydown:t[7]||(t[7]=S(k(()=>{},["prevent"]),["enter"])),type:"password",placeholder:"********"},null,8,["value"])]),_:1}),r(e(x),{path:"password_confirmation",label:"Confirmez le mot de passe",class:"w-1/2"},{default:a(()=>[r(e(q),{value:e(u).password_confirmation,"onUpdate:value":t[8]||(t[8]=p=>e(u).password_confirmation=p),onKeydown:t[9]||(t[9]=S(k(()=>{},["prevent"]),["enter"])),type:"password",placeholder:"********"},null,8,["value"])]),_:1})]),c("div",_e,[r(e(y),{type:"success",onClick:i,loading:e(v).isLoading.value},{default:a(()=>[ve]),_:1},8,["loading"])])])])]),_:1},8,["model"])]),_:1}))}});const xe={class:"flex gap-8"},he={class:"flex gap-8"},we={class:"flex justify-end"},ye=_("Mettre \xE0 mon profil"),Ee=_("Certification de stage"),be=c("p",null,"Upload d'un fichier pdf, word ou powerpoint, avec un max de 40Mo",-1),qe=_("Upload de la pr\xE9sentation du rapport"),Se=["href"],ke=_("Telecharger"),Ue=_("Fiche d'\xE9valuation de stage"),je=c("p",null,"Upload d'un fichier pdf, word ou powerpoint, avec un max de 40Mo",-1),$e=_("Upload de la pr\xE9sentation du rapport"),Me=["href"],Ne=_("Telecharger"),Pe=j({setup(m){const s=re(),n=P(),v=$(0),h=[{label:"Homme",value:"male"},{label:"Femmes",value:"female"}],E=[{label:"G\xE9nie Informatique",value:"GI"},{label:"G\xE9nie Electrique",value:"GE"},{label:"G\xE9nie Industriel",value:"GInd"},{label:"G\xE9nie M\xE9catronique d\u2019automobile",value:"GM"},{label:"R\xE9seaux et Syst\xE8mes de T\xE9l\xE9communications",value:"RST"}],u={profile:{apogee:{required:!0,trigger:["input","blur"],validator:(l,o)=>o?o.length>8?new Error("Numero apogee ne doit pas depasser 8 charactere"):!0:new Error("Numero apogee est requis")},field:{required:!0,trigger:["input","blur"],validator:(l,o)=>o?!0:new Error("La fili\xE8re est requise")},sex:{required:!0,trigger:["input","blur"],validator:(l,o)=>o?!0:new Error("La sexualit\xE9 est requise")},birthday:{required:!0,trigger:["input","blur"],validator:(l,o)=>o?!0:new Error("La date de naissance est requise")}}},b=$(null),i=A({user:{id:void 0,key:void 0,first_name:void 0,last_name:void 0,email:void 0,role:void 0,password:void 0,password_confirmation:void 0},profile:{apogee:void 0,birthday:void 0,field:void 0,profile_picture:void 0,sex:void 0,certificate:void 0,scorecard:void 0}}),f=()=>{b.value.validate(async l=>{if(l)n.error("veuillez entrer des donn\xE9es valides");else try{let o=N({},i.profile),d=new Date(o.birthday);o.birthday=d.toISOString().split("T")[0],await s.update(o),n.success("Profil mis \xE0 jour")}catch(o){console.log({err:o})}})};J(async()=>{await t()});const t=async()=>{try{let l=await s.getProfile();i.user=D(N({},ee.formatUser({id:l.data.id,first_name:l.data.first_name,last_name:l.data.last_name,email:l.data.email,role:l.data.role})),{password:null,password_confirmation:null}),i.profile={apogee:l.data.apogee,birthday:l.data.birthday?new Date(l.data.birthday).getTime():null,field:l.data.field,profile_picture:l.data.profile_picture,sex:l.data.sex,certificate:l.data.certificate,scorecard:l.data.scorecard}}catch{}},p=async(l,{file:o},d="ok")=>{n.info("Uploading...");const U=new FormData;U.append("file",o.file),s.uploadFile(l,U).then(async Ve=>{n.success(d)}).finally(async()=>{v.value++,await t()})};return(l,o)=>(g(),w(X,null,[r(e(M),{title:"Information profil",class:"mb-4"},{default:a(()=>[r(e(K),{model:e(i),ref:(d,U)=>{U.profileForm=d,b.value=d},rules:u},{default:a(()=>[c("div",xe,[r(e(x),{path:"profile.apogee",label:"Apogee",class:"w-1/2"},{default:a(()=>[r(e(q),{value:e(i).profile.apogee,"onUpdate:value":o[0]||(o[0]=d=>e(i).profile.apogee=d),onKeydown:o[1]||(o[1]=S(k(()=>{},["prevent"]),["enter"])),placeholder:"xxxxxxxx"},null,8,["value"])]),_:1}),r(e(x),{path:"profile.field",label:"Fili\xE8re",class:"w-1/2"},{default:a(()=>[r(e(G),{value:e(i).profile.field,"onUpdate:value":o[2]||(o[2]=d=>e(i).profile.field=d),options:E,placeholder:"fili\xE8re"},null,8,["value"])]),_:1})]),c("div",he,[r(e(x),{path:"profile.sex",label:"Sexe",class:"w-1/2"},{default:a(()=>[r(e(G),{value:e(i).profile.sex,"onUpdate:value":o[3]||(o[3]=d=>e(i).profile.sex=d),options:h,placeholder:"sexe"},null,8,["value"])]),_:1}),r(e(x),{path:"profile.birthday",label:"Date de naissance",class:"w-1/2"},{default:a(()=>[r(e(W),{value:e(i).profile.birthday,"onUpdate:value":o[4]||(o[4]=d=>e(i).profile.birthday=d),placeholder:"YYYY-MM-DD",type:"date",class:"w-full"},null,8,["value"])]),_:1})]),c("div",we,[r(e(y),{type:"success",onClick:f,loading:e(s).isLoading.value},{default:a(()=>[ye]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1}),(g(),w("div",{class:"grid grid-cols-2 gap-4",key:v.value},[r(e(M),null,{default:a(()=>[r(e(R),null,{default:a(()=>[Ee]),_:1}),be,r(e(F),{style:{display:"inline-block",width:"fit-content",height:"fit-content"},multiple:!1,customRequest:d=>p("certificate",d,"Votre certification a \xE9t\xE9 mise \xE0 jour"),accept:".pdf,.doc,.docx,.ppt,.pptx"},{default:a(()=>[r(e(y),{loading:e(s).isLoading.value},{default:a(()=>[qe]),_:1},8,["loading"])]),_:1},8,["customRequest"]),e(i).profile.certificate?(g(),w("a",{key:0,href:e(i).profile.certificate,target:"_blank"},[r(e(y),{class:"ml-4",type:"success"},{default:a(()=>[ke]),_:1})],8,Se)):L("",!0)]),_:1}),r(e(M),null,{default:a(()=>[r(e(R),null,{default:a(()=>[Ue]),_:1}),je,r(e(F),{style:{display:"inline-block",width:"fit-content",height:"fit-content"},multiple:!1,customRequest:d=>p("scorecard",d,"Votre certification a \xE9t\xE9 mise \xE0 jour"),accept:".pdf,.doc,.docx,.ppt,.pptx"},{default:a(()=>[r(e(y),{loading:e(s).isLoading.value},{default:a(()=>[$e]),_:1},8,["loading"])]),_:1},8,["customRequest"]),e(i).profile.scorecard?(g(),w("a",{key:0,href:e(i).profile.scorecard,target:"_blank"},[r(e(y),{class:"ml-4",type:"success"},{default:a(()=>[Ne]),_:1})],8,Me)):L("",!0)]),_:1})]))],64))}}),Fe={class:"flex items-center gap-8"},Re=_("Mon profil"),Le={key:0},Be=j({setup(m){const s=V();return(n,v)=>(g(),w("div",null,[c("div",Fe,[c("div",null,[r(e(R),{class:"block"},{default:a(()=>[Re]),_:1})])]),r(ge),e(s).role=="student"?(g(),w("div",Le,[r(Pe)])):L("",!0)]))}});export{Be as default};
