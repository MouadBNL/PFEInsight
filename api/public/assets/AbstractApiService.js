var n=Object.defineProperty;var i=(a,e,s)=>e in a?n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var o=(a,e,s)=>(i(a,typeof e!="symbol"?e+"":e,s),s);import{A as l,B as d,l as h,k as p}from"./vendor.js";const c="http://localhost:8000/";function g(a){return typeof(a==null?void 0:a.response)=="object"}class f{constructor(e,s=c+"api/v1"){o(this,"http");o(this,"message");o(this,"loadingBar");o(this,"isLoading");this.path=e,this.baseURL=s,this.message=l(),this.loadingBar=d(),this.isLoading=h(!1),e&&(s+=e),this.http=p.create({baseURL:s}),this.http.interceptors.request.use(t=>(this.isLoading.value=!0,this.loadingBar.start(),t),t=>(this.isLoading.value=!1,this.loadingBar.error(),Promise.reject(t))),this.http.interceptors.response.use(t=>(this.isLoading.value=!1,this.loadingBar.finish(),t),t=>(this.isLoading.value=!1,this.loadingBar.error(),Promise.reject(t))),this.http.defaults.headers.common.Accept="application/json;charset=UTF-8",this.http.defaults.headers.common["Content-Type"]="application/json;charset=UTF-8",this.loadHeaderToken()}createParams(e){const s=new URLSearchParams;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const r=e[t];r!=null?s.append(t,r):console.debug(`Param key '${t}' was null or undefined and will be ignored`)}return s}handleResponse(e){return e.data}handleError(e){var s,t;if(e instanceof Error)if(g(e)){if(e.response)throw((s=e.response.data)==null?void 0:s.errors)&&e.response.data.errors[Object.keys(e.response.data.errors)[0]][0]?(console.log(e.response.data.errors[Object.keys(e.response.data.errors)[0]][0]),this.message.error(e.response.data.errors[Object.keys(e.response.data.errors)[0]][0])):e.response.data!==void 0&&e.response.data.message?(console.log(e.response.data.message),this.message.error(e.response.data.message),e.response.data.message=="Unauthenticated."&&(console.log("redirecting to login"),window.location.reload())):((t=e.response.data)==null?void 0:t.status)&&this.message.error(e.response.data.status),e;if(e.request)throw this.message.error("une erreur s'est produite, veuillez v\xE9rifier votre connexion Internet"),new Error(e)}else throw this.message.error("une erreur s'est produite, veuillez v\xE9rifier votre connexion Internet"),new Error(e.message);throw new Error(e)}setHeaderToken(e){this.http.defaults.headers.common.Authorization=`Bearer ${e}`,e?(localStorage.setItem("jwt_token",e),this.loadHeaderToken()):localStorage.removeItem("jwt_token")}loadHeaderToken(){localStorage.getItem("jwt_token")&&(this.http.defaults.headers.common.Authorization=`Bearer ${localStorage.getItem("jwt_token")}`)}}export{f as A,c as b};
